
<!doctype html>
<html lang="en" class="dark-style layout-wide customizer-hide" dir="ltr" data-theme="theme-default" data-assets-path="./assets/" data-template="horizondal-menu-template-free" data-style="dark-style">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0" />
    <title>ASR BUSINESS</title>
    <meta name="description" content="" />
    <link rel="icon" type="image/x-icon" href="./../assets/images/logo.png" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Public+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="./assets/vendor/fonts/boxicons.css" />
    <link rel="stylesheet" href="./assets/vendor/css/rtl/core.css" class="template-customizer-core-css" />
    <link rel="stylesheet" href="./assets/vendor/css/rtl/theme-default.css" class="template-customizer-theme-css" />
    <link rel="stylesheet" href="./assets/css/demo.css" />
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <link rel="stylesheet" href="./assets/vendor/libs/perfect-scrollbar/perfect-scrollbar.css" />
    <link rel="stylesheet" href="./assets/vendor/css/pages/page-auth.css" />
    <script src="./assets/vendor/js/helpers.js"></script>
    <script src="./assets/js/config.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.10.7/dist/sweetalert2.all.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/sweetalert2@11.10.7/dist/sweetalert2.min.css" rel="stylesheet">
    <!-- Add this in your <head> section -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/css/intlTelInput.css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/js/intlTelInput.min.js"></script>
<script>
        document.addEventListener("DOMContentLoaded", function () {
            // Initialize intl-tel-input
            const input = window.intlTelInput(document.querySelector("#phone"), {
                initialCountry: "in", // Set default country code to India
                utilsScript: "https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/lib/libphonenumber.js" // Optional for formatting
            });
        });
    </script>
<style>
  .iti {
    position: relative;
    display: block !important;
}
</style>
</head>
<body>
<div class="container-xxl">
    <div class="authentication-wrapper authentication-basic container-p-y">
        <div class="authentication-inner">
            <div class="card px-sm-6 px-0">
                <div class="card-body">
                    <div class="app-brand justify-content-center mb-6">
                        <a href="index.html" class="app-brand-link gap-2">
                            <img src="./../assets/images/logo.png" alt="ASR BUSINESS" width="180px">
                        </a>
                    </div>
                    <h4 class="mb-1">Investment starts here ðŸš€</h4>
                    <p class="mb-6">Make your Investment easy and fun!</p>

                    <form role="form" id="signupForm" action="api/register.php" method="POST" onsubmit="disableButton(); return validateForm()">
                        <div class="mb-3 row">
                            <div class="col-md-6 mb-3">
                                <input type="text" class="form-control" placeholder="First Name" name="first_name" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <input type="text" class="form-control" placeholder="Last Name" name="last_name" required>
                            </div>
                        </div>
                        <div class="mb-3 row">
                            <div class="col-md-6 mb-3">
                                <input type="text" class="form-control" placeholder="Referral Code" id="referralCode" onkeyup="checkReferralCode()" name="referral_code" value="" required>
                                <div id="referralCodeError" class="error-message text-danger"></div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <input type="text" class="form-control" placeholder="Referral Name" id="referralPersonName" readonly name="referral_name">
                            </div>
                        </div>
                        <div class="mb-3 row">
                            <div class="col-md-6 mb-3">
                                <input type="text" class="form-control" placeholder="User ID" name="user_id" id="userId" onkeyup="checkUserId()" required>
                                <div id="userIdError" class="error-message text-danger"></div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <input type="email" class="form-control" placeholder="Email" name="email" id="email" onkeyup="checkEmail()" required>
                                <div id="emailError" class="error-message text-danger"></div>
                            </div>
                        </div>
                        <div class="mb-3 row">
                            <div class="col-12 mb-3">
                                <input type="tel" id="phone" name="phone_number" class="form-control" placeholder="Phone Number" required>
                                <div id="phoneError" class="error-message text-danger"></div>
                            </div>
                        </div>
                        <div class="mb-3 row">
                            <div class="col-md-6 mb-3">
                                <input type="password" class="form-control" placeholder="Password" id="password" name="password" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <input type="password" class="form-control" placeholder="Confirm Password" id="confirmPassword" name="confirm_password" required>
                            </div>
                        </div>
                        <div class="text-center">
                            <button type="submit" id="signupButton" class="btn btn-primary w-100 mb-0">Sign up</button>
                        </div>
                    </form>
                    <p class="text-center mt-4">
                        <span>Already have an account?</span>
                        <a href="./index.php"><span>Sign in instead</span></a>
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            var referralCodeInput = document.getElementById('referralCode');
            referralCodeInput.value = 'Nagaraj';
            checkReferralCode();
        });
    </script>

<script>
    // Check for registration success message
    var urlParams = new URLSearchParams(window.location.search);
    var registrationSuccessMessage = urlParams.get('success');

    // If registration was successful, show popup
    if (registrationSuccessMessage) {
        Swal.fire({
            icon: 'success',
            title: 'Success!',
            text: registrationSuccessMessage
        }).then((result) => {
            if (result.isConfirmed) {
                window.location.href = 'index.php';
            }
        });
    }
</script>



<script>
    function disableButton() {
        document.getElementById('signupButton').disabled = true;
    }

    function enableButton() {
        document.getElementById('signupButton').disabled = false;
    }

    function checkReferralCode() {
        var referralCode = document.getElementById('referralCode').value;
        var referralPersonNameField = document.getElementById('referralPersonName');
        var referralCodeError = document.getElementById('referralCodeError');

        fetch('api/check_refferal.php?referral_code=' + referralCode)
            .then(response => response.json())
            .then(data => {
                if (data.active) {
                    referralPersonNameField.value = data.referralPersonName;
                    referralCodeError.innerText = '';
                    enableButton();
                } else {
                    referralPersonNameField.value = '';
                    referralCodeError.innerText = data.message;
                    disableButton();
                }
            })
            .catch(error => console.error('Error:', error));
    }

    function checkEmail() {
        var email = document.getElementById('email').value;
        var emailError = document.getElementById('emailError');

        disableButton();

        fetch('api/check_email.php?email=' + email)
            .then(response => response.json())
            .then(data => {
                if (data.exists) {
                    emailError.innerText = 'Email already exists';
                    disableButton();
                } else {
                    emailError.innerText = '';
                    enableButton();
                }
            })
            .catch(error => console.error('Error:', error));
    }

    function checkUserId() {
        var userId = document.getElementById('userId').value;
        var userIdError = document.getElementById('userIdError');

        disableButton();

        fetch('api/check_user_id.php?user_id=' + userId)
            .then(response => response.json())
            .then(data => {
                if (data.exists) {
                    userIdError.innerText = 'User ID already exists';
                    disableButton();
                } else {
                    userIdError.innerText = '';
                    enableButton();
                }
            })
            .catch(error => console.error('Error:', error));
    }

    function validatePhoneNumber() {
        var phoneInput = document.getElementById('phone_number');
        var phoneError = document.getElementById('phoneError');
        var phoneNumber = phoneInput.value;

        if (phoneNumber.length < 10) {
            phoneError.innerText = 'Phone number must be 10 digits';
            disableButton();
        } else {
            phoneError.innerText = '';
            enableButton();
        }
    }

    function validateForm() {
        var password = document.getElementById('password').value;
        var confirmPassword = document.getElementById('confirmPassword').value;
        var passwordError = document.getElementById('passwordError');

        if (password !== confirmPassword) {
            passwordError.innerText = 'Passwords do not match';
            return false;
        } else {
            passwordError.innerText = '';
            return true;
        }
    }
</script>


<script>


    // Initialize intl-tel-input
    var input = document.querySelector("#phone");
    window.intlTelInput(input, {
        // Options
        utilsScript: "https://cdnjs.cloudflare.com/ajax/libs/intl-tel-input/17.0.8/js/utils.js", // Just for formatting/placeholders etc.
    });

    function validatePhoneNumber() {
        var iti = window.intlTelInputGlobals.getInstance(input);
        var phoneError = document.getElementById('phoneError');

        // Validate phone number
        if (iti.isValidNumber()) {
            phoneError.innerText = '';
            enableButton();
        } else {
            phoneError.innerText = 'Invalid phone number';
            disableButton();
        }
    }

    // Attach the validation function to the input field
    input.addEventListener('blur', validatePhoneNumber);
</script>


</body>
</html>
